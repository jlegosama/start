var test=require("tape"),shimmedKeys=require("../index.js"),is=require("is"),keys=require("../shim.js"),forEach=require("foreach"),indexOf=require("indexof"),obj={str:"boz",obj:{},arr:[],bool:!0,num:42,aNull:null,undef:undefined},objKeys=["str","obj","arr","bool","num","aNull","undef"];test("exports a function",function(e){Object.keys?e.equal(Object.keys,shimmedKeys,"Object.keys is supported and exported"):e.equal(keys,shimmedKeys,"Object.keys is not supported; shim is exported");e.end()});test("working with actual shim",function(e){e.notEqual(Object.keys,keys,"keys shim is not native Object.keys");e.end()});test("works with an object literal",function(e){var t=keys(obj);e.equal(is.array(t),!0,"returns an array");e.deepEqual(t,objKeys,"Object has expected keys");e.end()});test("works with an array",function(e){var t=[1,2,3],n=keys(t);e.equal(is.array(n),!0,"returns an array");e.deepEqual(n,["0","1","2"],"Array has expected keys");e.end()});test("works with a function",function(e){var t=function(){};t.a=!0;e.doesNotThrow(function(){return keys(t)},"does not throw an error");e.deepEqual(keys(t),["a"],"returns expected keys");e.end()});test("returns names which are own properties",function(e){forEach(keys(obj),function(n){e.equal(obj.hasOwnProperty(n),!0,n+" should be returned")});e.end()});test("returns names which are enumerable",function(e){var t,n=[];for(t in obj)n.push(t);forEach(keys(obj),function(t){e.notEqual(indexOf(n,t),-1,t+" is not enumerable")});e.end()});test("throws an error for a non-object",function(e){e.throws(function(){return keys(42)},new TypeError("Object.keys called on a non-object"),"throws on a non-object");e.end()});test("works with an object instance",function(e){var t=function(){};t.prototype.foo=!0;var n=new t;n.bar=!0;var r=keys(n);e.equal(is.array(r),!0,"returns an array");e.deepEqual(r,["bar"],"Instance has expected keys");e.end()});test("works in iOS 5 mobile Safari",function(e){var t=function(){};t.a=function(){};e.deepEqual(keys(t),["a"],"has expected keys");e.end()});test("works in environments with the dontEnum bug (IE < 9)",function(e){var t=function(){};t.prototype.a=function(){};e.deepEqual(keys(t.prototype),["a"],"has expected keys");e.end()});test("shadowed properties",function(e){var t=["dummyControlProp","constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];t.sort();var n={};forEach(t,function(e,t){n[e]=t});var r=keys(n);r.sort();e.deepEqual(r,t,"troublesome shadowed properties are keys of object literals");e.end()});