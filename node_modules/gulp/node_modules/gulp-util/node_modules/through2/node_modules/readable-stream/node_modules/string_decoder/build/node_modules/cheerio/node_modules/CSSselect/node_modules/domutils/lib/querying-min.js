exports.find=function(e,t,n,r){var i=[],s;for(var o=0,u=t.length;o<u;o++){if(e(t[o])){i.push(t[o]);if(--r<=0)break}s=this.getChildren(t[o]);if(n&&s&&s.length>0){s=this.find(e,s,n,r);i=i.concat(s);r-=s.length;if(r<=0)break}}return i};exports.findOneChild=function(e,t){for(var n=0,r=t.length;n<r;n++)if(e(t[n]))return t[n];return null};exports.findOne=function(e,t){var n=null;for(var r=0,i=t.length;r<i&&!n;r++)e(t[r])?n=t[r]:t[r].children&&t[r].children.length>0&&(n=this.findOne(e,t[r].children));return n};exports.findAll=function(e,t){var n=[];for(var r=0,i=t.length;r<i;r++){e(t[r])&&n.push(t[r]);var s=this.getChildren(t[r]);s&&s.length&&(n=n.concat(this.findAll(e,s)))}return n};exports.filter=function(e,t,n,r){Array.isArray(t)||(t=[t]);if(typeof r!="number"||!isFinite(r))return n===!1?t.filter(e):this.findAll(e,t);if(r===1){n===!1?t=this.findOneChild(e,t):t=this.findOne(e,t);return t?[t]:[]}return this.find(e,t,n!==!1,r)};