function through(e,t){function o(){while(i.length&&!s.paused){var e=i.shift();if(null===e)return s.emit("end");s.emit("data",e)}}function u(){s.writable=!1;t.call(s);s.readable||s.destroy()}e=e||function(e){this.queue(e)};t=t||function(){this.queue(null)};var n=!1,r=!1,i=[],s=new Stream;s.readable=s.writable=!0;s.paused=!1;s.write=function(t){e.call(this,t);return!s.paused};s.queue=s.push=function(e){i.push(e);o();return s};s.on("end",function(){s.readable=!1;s.writable||process.nextTick(function(){s.destroy()})});s.end=function(e){if(n)return;n=!0;arguments.length&&s.write(e);u();return s};s.destroy=function(){if(r)return;r=!0;n=!0;i.length=0;s.writable=s.readable=!1;s.emit("close");return s};s.pause=function(){if(s.paused)return;s.paused=!0;s.emit("pause");return s};s.resume=function(){s.paused&&(s.paused=!1);o();s.paused||s.emit("drain");return s};return s}var Stream=require("stream");exports=module.exports=through;through.through=through;