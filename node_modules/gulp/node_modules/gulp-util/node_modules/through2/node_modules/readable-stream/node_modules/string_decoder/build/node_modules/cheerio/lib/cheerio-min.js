/*
  Module dependencies
*/var path=require("path"),parse=require("./parse"),evaluate=parse.evaluate,_=require("underscore"),api=["attributes","traversing","manipulation","css"],quickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,$=require("./static"),Cheerio=module.exports=function(e,t,n){if(this instanceof Cheerio){if(!e)return this;if(n){typeof n=="string"&&(n=parse(n));this._root=Cheerio.call(this,n)}if(e.cheerio)return e;if(e.name||e.type==="text"||e.type==="comment")e=[e];if(Array.isArray(e)){_.forEach(e,function(e,t){this[t]=e},this);this.length=e.length;return this}if(typeof e=="string"&&isHtml(e))return Cheerio.call(this,parse(e).children);if(!t)t=this._root;else if(typeof t=="string")if(isHtml(t)){t=parse(t);t=Cheerio.call(this,t)}else{e=[t,e].join(" ");t=this._root}return t?t.find(e):this}return new Cheerio(e,t,n)};_.extend(Cheerio,require("./static"));Cheerio.prototype.cheerio="[cheerio object]";Cheerio.prototype.options={normalizeWhitespace:!1,xmlMode:!1,lowerCaseTags:!1};Cheerio.prototype.length=0;Cheerio.prototype.splice=Array.prototype.splice;var isHtml=function(e){if(e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3)return!0;var t=quickExpr.exec(e);return!!t&&!!t[1]};Cheerio.prototype._make=function(e){var t=new Cheerio(e);t.prevObject=this;return t};Cheerio.prototype.toArray=function(){return[].slice.call(this,0)};api.forEach(function(e){_.extend(Cheerio.prototype,require("./api/"+e))});