function check(e,t){function i(e){r+=e}function s(){e.equal(r,"BEEP BOOP.")}var n=hyperquest.post("http://localhost:"+t);n.pipe(through(i,s));setTimeout(function(){n.write("beep ")},50);setTimeout(function(){n.end("boop.")},100);var r=""}var test=require("tap").test,http=require("http"),hyperquest=require("../"),through=require("through"),server=http.createServer(function(e,t){e.pipe(through(function(e){this.queue(String(e).toUpperCase())})).pipe(t)});test("post",function(e){e.plan(1);server.listen(0,function(){var n=server.address().port;check(e,n)});e.on("end",server.close.bind(server))});