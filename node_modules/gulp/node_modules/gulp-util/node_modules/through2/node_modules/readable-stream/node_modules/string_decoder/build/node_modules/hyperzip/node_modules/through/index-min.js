function through(e,t,n){function a(){while(s.length&&!u.paused){var e=s.shift();if(null===e)return u.emit("end");u.emit("data",e)}}function f(){u.writable=!1;t.call(u);!u.readable&&u.autoDestroy&&u.destroy()}e=e||function(e){this.queue(e)};t=t||function(){this.queue(null)};var r=!1,i=!1,s=[],o=!1,u=new Stream;u.readable=u.writable=!0;u.paused=!1;u.autoDestroy=!n||n.autoDestroy!==!1;u.write=function(t){e.call(this,t);return!u.paused};u.queue=u.push=function(e){if(o)return u;e==null&&(o=!0);s.push(e);a();return u};u.on("end",function(){u.readable=!1;!u.writable&&u.autoDestroy&&process.nextTick(function(){u.destroy()})});u.end=function(e){if(r)return;r=!0;arguments.length&&u.write(e);f();return u};u.destroy=function(){if(i)return;i=!0;r=!0;s.length=0;u.writable=u.readable=!1;u.emit("close");return u};u.pause=function(){if(u.paused)return;u.paused=!0;return u};u.resume=function(){if(u.paused){u.paused=!1;u.emit("resume")}a();u.paused||u.emit("drain");return u};return u}var Stream=require("stream");exports=module.exports=through;through.through=through;