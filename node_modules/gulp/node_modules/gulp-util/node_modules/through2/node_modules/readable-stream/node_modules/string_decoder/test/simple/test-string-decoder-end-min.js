// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
// verify that the string decoder works getting 1 byte at a time,
// the whole buffer at once, and that both match the .toString(enc)
// result of the entire buffer.
function testEncoding(e){bufs.forEach(function(t){testBuf(e,t)})}function testBuf(e,t){console.error("# %s",e,t);var n=new SD(e),r="";for(var i=0;i<t.length;i++)r+=n.write(t.slice(i,i+1));r+=n.end();var s="",n=new SD(e);s+=n.write(t);s+=n.end();var o=t.toString(e);console.log("expect=%j",o);assert.equal(r,o,"one byte at a time should match toString");assert.equal(s,o,"all bytes at once should match toString")}var assert=require("assert"),SD=require("../../").StringDecoder,encodings=["base64","hex","utf8","utf16le","ucs2"],bufs=["â˜ƒðŸ’©ï£¿","asdf"].map(function(e){return new Buffer(e)});for(var i=1;i<=16;i++){var bytes=(new Array(i)).join(".").split(".").map(function(e,t){return t+120});bufs.push(new Buffer(bytes))}encodings.forEach(testEncoding);console.log("ok");