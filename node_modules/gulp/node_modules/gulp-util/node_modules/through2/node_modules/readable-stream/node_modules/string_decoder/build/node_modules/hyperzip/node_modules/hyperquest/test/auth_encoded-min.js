function checkUnauth(e,t){var n=hyperquest("http://localhost:"+t),r="";n.on("data",function(e){r+=e});n.on("end",function(){e.equal(r,"ACCESS DENIED")})}function checkValid(e,t){var n=hyperquest("http://m%23%23:h%40x@localhost:"+t),r="";n.on("data",function(e){r+=e});n.on("end",function(){e.equal(r,"WELCOME TO ZOMBO COM")})}function checkInvalid(e,t){var n=hyperquest("http://beep:boop@localhost:"+t),r="";n.on("data",function(e){r+=e});n.on("end",function(){e.equal(r,"ACCESS DENIED!!!")})}var test=require("tap").test,http=require("http"),hyperquest=require("../"),through=require("through"),server=http.createServer(function(e,t){var n=e.headers.authorization;if(!n)return t.end("ACCESS DENIED");var r=Buffer(n.replace(/^Basic\s+/,""),"base64"),i=r.toString().split(":");i[0]==="m##"&&i[1]==="h@x"?t.end("WELCOME TO ZOMBO COM"):t.end("ACCESS DENIED!!!")});test("basic auth with escaped params",function(e){e.plan(3);server.listen(0,function(){var n=server.address().port;checkUnauth(e,n);checkValid(e,n);checkInvalid(e,n)});e.on("end",server.close.bind(server))});