var fs=require("fs"),path=require("path"),Benchmark=require("benchmark"),jsdom=require("jsdom"),cheerio=require(".."),documentDir=path.join(__dirname,"documents"),jQuerySrc=path.join(__dirname,"jquery-2.0.3.js"),filterRe=/./,Suites=module.exports=function(){};Suites.prototype.filter=function(e){filterRe=new RegExp(e,"i")};Suites.prototype.add=function(e,t,n){var r,i,s;if(!filterRe.test(e))return;r=fs.readFileSync(path.join(documentDir,t));i=new Benchmark.Suite(e);s=n.test;i.on("start",function(n){console.log("Test: "+e+" (file: "+t+")")});i.on("cycle",function(e){if(e.target.error)return;console.log("	"+String(e.target))});i.on("error",function(e){console.log("*** Error in "+e.target.name+": ***");console.log("	"+e.target.error);console.log("*** Test invalidated. ***")});i.on("complete",function(e){if(e.target.error){console.log();return}console.log("	Fastest: "+this.filter("fastest").pluck("name")+"\n")});this._benchCheerio(i,r,n);this._benchJsDom(i,r,n)};Suites.prototype._benchJsDom=function(e,t,n){var r=n.test;jsdom.env({html:t,scripts:jQuerySrc,done:function(t,i){var s;n.setup&&(s=n.setup.call(null,i.$));e.add("jsdom",function(){r.call(null,i.$,s)});e.run()}})};Suites.prototype._benchCheerio=function(e,t,n){var r=cheerio.load(t),i=n.test,s;n.setup&&(s=n.setup.call(null,r));e.add("cheerio",function(){i.call(null,r,s)})};