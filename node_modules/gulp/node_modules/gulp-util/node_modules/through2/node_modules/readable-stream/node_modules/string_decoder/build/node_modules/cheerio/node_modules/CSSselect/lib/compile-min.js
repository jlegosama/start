/*
	compiles a selector to an executable function
*/function compile(e,t){var n=parse(e,t).map(compileRules).reduce(reduceRules,falseFunc);return function(e){return isTag(e)&&n(e)}}function compileRules(e){return e.length===0?falseFunc:sortRules(e).reduce(function(e,t){return e===falseFunc?e:Rules[t.type](e,t)},trueFunc)}function reduceRules(e,t){return t===falseFunc||e===trueFunc?e:e===falseFunc||t===trueFunc?t:function(r){return e(r)||t(r)}}module.exports=compile;var parse=require("CSSwhat"),DomUtils=require("domutils"),isTag=DomUtils.isTag,Rules=require("./general.js"),sortRules=require("./sort.js"),BaseFuncs=require("./basefunctions.js"),trueFunc=BaseFuncs.trueFunc,falseFunc=BaseFuncs.falseFunc,Pseudos=require("./pseudos.js"),filters=Pseudos.filters,isParent=Pseudos.pseudos.parent,findOne=DomUtils.findOne,getChildren=DomUtils.getChildren;filters.not=function(e,t){var n=compile(t);return n===falseFunc?e:n===trueFunc?falseFunc:function(t){return!n(t)&&e(t)}};filters.has=function(e,t){var n=compile(t);return n===falseFunc?falseFunc:n===trueFunc?function(t){return isParent(t)&&e(t)}:function(r){return e(r)&&findOne(n,getChildren(r))!==null}};