"use strict";var gulp=require("../"),Q=require("q"),should=require("should");require("mocha");describe("gulp tasks",function(){describe("task()",function(){it("should define a task",function(e){var t;t=function(){};gulp.task("test",t);should.exist(gulp.tasks.test);gulp.tasks.test.fn.should.equal(t);gulp.reset();e()})});describe("run()",function(){it("should run multiple tasks",function(e){var t,n,r;t=0;n=function(){this.should.equal(gulp);++t};r=function(){this.should.equal(gulp);++t};gulp.task("test",n);gulp.task("test2",r);gulp.run("test","test2");t.should.equal(2);gulp.reset();e()});it("should run all tasks when call run() multiple times",function(e){var t,n,r;t=0;n=function(){this.should.equal(gulp);++t};r=function(){this.should.equal(gulp);++t};gulp.task("test",n);gulp.task("test2",r);gulp.run("test");gulp.run("test2");t.should.equal(2);gulp.reset();e()});it("should run all async promise tasks",function(e){var t,n,r;t=0;n=function(){var e=Q.defer();setTimeout(function(){++t;e.resolve()},1);return e.promise};r=function(){var e=Q.defer();setTimeout(function(){++t;e.resolve()},1);return e.promise};gulp.task("test",n);gulp.task("test2",r);gulp.run("test");gulp.run("test2",function(){gulp.isRunning.should.equal(!1);t.should.equal(2);gulp.reset();e()});gulp.isRunning.should.equal(!0)});it("should run all async callback tasks",function(e){var t,n,r;t=0;n=function(e){setTimeout(function(){++t;e(null)},1)};r=function(e){setTimeout(function(){++t;e(null)},1)};gulp.task("test",n);gulp.task("test2",r);gulp.run("test");gulp.run("test2",function(){gulp.isRunning.should.equal(!1);t.should.equal(2);gulp.reset();e()});gulp.isRunning.should.equal(!0)});it("should emit task_not_found and throw an error when task is not defined",function(e){gulp.on("task_not_found",function(t){should.exist(t);should.exist(t.task);t.task.should.equal("test");gulp.reset();e()});try{gulp.run("test")}catch(t){should.exist(t)}});it("should run task scoped to gulp",function(e){var t,n;t=0;n=function(){this.should.equal(gulp);++t};gulp.task("test",n);gulp.run("test");t.should.equal(1);gulp.isRunning.should.equal(!1);gulp.reset();e()});it("should run default task scoped to gulp",function(e){var t,n;t=0;n=function(){this.should.equal(gulp);++t};gulp.task("default",n);gulp.run();t.should.equal(1);gulp.isRunning.should.equal(!1);gulp.reset();e()})})});